---
title: Git Log 命令：你可能不知道的实用小技巧
date: 2020-07-31 16:59:23
tags: ["git", "best-practices", "development", "cli"]
---

本文翻译自[Useful tricks you might not know about git log](https://gitbetter.substack.com/p/useful-tricks-you-might-not-know)。

如果你已经使用 Git 一段时间，那么 `git log` 命令你一定不陌生。它是一个基础但强大的工具，用于查看项目的提交历史和变更记录。

然而，`git log` 的功能远不止于此。它提供了许多选项（参数），可以帮助我们更精确、更高效地浏览和筛选项目历史。本文将介绍一些非常实用但可能不太常见的 `git log` 用法。

<!-- more -->

## 1. 查看简洁的单行日志：`--oneline`

当你只想快速概览提交历史，而不需要详细信息时，`--oneline` 参数非常有用。

```bash
git log --oneline
```

这个命令会将每次提交压缩到一行显示，只包含短哈希值和提交消息，看起来非常清爽。

## 2. 按时间段筛选提交
你可以使用 --after 和 --before 参数来筛选特定时间范围内的提交。

- 指定日期筛选：
- 使用相对日期筛选： Git 还支持更自然的相对时间表达：
## 3. 查看提交的具体变更：-p 或 --patch
如果你想知道每次提交具体修改了哪些内容，可以使用 -p 参数。

该命令会在显示提交信息的同时，附带每次提交的详细差异（diff），让你清楚地看到代码的增删改。

上图展示了包含 diff 信息的日志输出。

## 4. 按作者筛选提交：--author
想查看某个特定成员的提交记录？ --author 参数可以帮你实现。

这个命令会筛选出指定作者的所有提交。Git 会使用正则表达式进行模式匹配，所以通常不需要完全精确匹配，并且默认是区分大小写的（但行为可能因 Git 版本和配置略有不同）。

组合使用参数： git log 的参数可以组合使用，实现更复杂的筛选。例如：

## 5. 按提交消息筛选提交：--grep
如果你记得提交消息中的某个关键词（比如关联的任务 ID 或 Bug 编号），可以使用 --grep 参数来搜索。

Git 会使用正则表达式进行匹配。默认情况下，搜索是 区分大小写 的。

- 忽略大小写搜索： 添加 -i 参数。
- 搜索多个模式（OR）： 使用 \| 连接不同的模式（注意可能需要引号或转义）。
## 6. 按文件筛选提交：<路径/文件名>
想查看某个或某些特定文件的修改历史？直接在 git log 命令后跟上文件路径即可。

组合使用： 同样可以与其他参数组合。

## 7. 按文件内容变更筛选提交：-S
这是一个非常强大的功能！如果你想查找 引入或删除了特定代码片段 （比如某个函数名或特定字符串）的提交，可以使用 -S 参数（注意是大写的 S）。

这个命令会搜索提交的 变更内容 （diff），而不是提交消息。默认区分大小写。

- 忽略大小写并查看差异：
## 8. 仅显示合并提交：--merges
如果你只关心分支的合并历史，比如想看看特性分支是何时合并到主干的，可以使用 --merges 参数。

这个命令会过滤掉普通的提交，只显示合并提交记录。

## 9. 显示两个分支间的差异提交：..
想知道一个分支相对于另一个分支多了哪些提交？可以使用 .. 语法。

这个命令可以帮助你了解 develop 分支领先 master 分支多少工作量。 注意： 在比较前，最好先 git fetch 或 git pull 更新本地仓库，确保比较的是最新的状态。

## 10. 自定义日志输出格式：--pretty=format
觉得默认的日志格式信息太多或太少？ git log 允许你通过 --pretty=format:"<格式字符串>" 来自定义输出。

```bash
git log --pretty=format:"%Cred%an - %ar%n %Cblue %h -%Cgreen %s %n"
 ```
```

上图展示了自定义格式的日志输出。

常用的格式占位符：

- %h : 短哈希值
- %H : 完整哈希值
- %an : 作者名字
- %ae : 作者邮箱
- %ad : 作者提交日期 (格式可定制)
- %ar : 作者提交日期 (相对时间，如 "2 hours ago")
- %cn : 提交者名字
- %cr : 提交者日期 (相对时间)
- %s : 提交消息主题 (单行)
- %Cred , %Cgreen , %Cblue , %Creset : 设置颜色
你可以组合这些占位符，并添加颜色，创建完全符合你需求的日志视图。更多格式选项可以查阅 Git 官方文档 。

希望这些 git log 的小技巧能帮助你更高效地使用 Git！熟练运用它们，可以大大提升你浏览和理解项目历史的效率。
